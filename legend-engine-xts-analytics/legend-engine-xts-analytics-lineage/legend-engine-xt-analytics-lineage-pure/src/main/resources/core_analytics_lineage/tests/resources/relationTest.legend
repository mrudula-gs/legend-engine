###Relational
Database meta::analytics::lineage::tests::db
(
  Table personTable (ID INT PRIMARY KEY, FIRSTNAME VARCHAR(200), LASTNAME VARCHAR(200), AGE INT, ADDRESSID INT, FIRMID INT, MANAGERID INT)
    Table firmTable (FIRM_ID INT PRIMARY KEY, NAME VARCHAR(200))

)


###Pure
function  meta::analytics::lineage::tests::relation::extendOlapRelation():Relation<Any>[1]
{
   #>{meta::analytics::lineage::tests::db.personTable}#->select(~[LASTNAME,AGE])->extend(~newCol:c|$c.AGE:y|$y->plus())
               
}

###Pure
function  meta::analytics::lineage::tests::relation::pivot():Relation<Any>[1]
{
  #>{meta::analytics::lineage::tests::db.personTable}#->select(~[FIRSTNAME,LASTNAME,AGE,ADDRESSID])->pivot(~[LASTNAME], ~[newCol : x | $x.AGE->toOne() * $x.ADDRESSID->toOne() : y | $y->plus()]);

                
}
###Pure
function  meta::analytics::lineage::tests::relation::olapWindow():Relation<Any>[1]
{
#>{meta::analytics::lineage::tests::db.personTable}#->select(~[LASTNAME,AGE])->extend(over(~LASTNAME), ~newCol:{p,w,r|$r.AGE}:y|$y->plus())->distinct();

                
}

###Pure
function  meta::analytics::lineage::tests::relation::selectExtend():Relation<Any>[1]
{
#>{meta::analytics::lineage::tests::db.personTable}#->select(~[FIRSTNAME, LASTNAME])->extend(~['firstNameExtend': x| $x.FIRSTNAME   ] ) ;

                
}



###Pure
function analytics::lineage::tests::relation::simpleSQLAccessor():Relation<Any>[1]
{
  #SQL{select FIRSTNAME from tb('meta::analytics::lineage::tests::db.personTable') as t where t.FIRSTNAME = 'www'}#;
}

//function analytics::lineage::tests::relation::joinOnSQLAccessor():Relation<Any>[1]
//{
  //#SQL{select FIRSTNAME,FIRMID from tb('meta::analytics::lineage::tests::db.personTable')}#->join( #SQL{select FIRM_ID from tb('meta::analytics::lineage::tests::db.firmTable')}#, JoinKind.INNER, {x,y| $x.FIRMID == $y.FIRM_ID}) ;
//}
